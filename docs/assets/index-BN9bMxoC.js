(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))d(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&d(s)}).observe(document,{childList:!0,subtree:!0});function c(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function d(t){if(t.ep)return;t.ep=!0;const o=c(t);fetch(t.href,o)}})();const b=(()=>{const u="data-data",l="main",c="https://api.github.com";let d="",t="";function o(e){return crypto.subtle.digest("SHA-256",new TextEncoder().encode(e)).then(r=>Array.from(new Uint8Array(r)).map(n=>n.toString(16).padStart(2,"0")).join(""))}async function s(e,r,n=null){const i=await fetch(r,{method:e,headers:{Authorization:`Bearer ${d}`,Accept:"application/vnd.github+json","Content-Type":"application/json"},body:n?JSON.stringify(n):void 0});if(!i.ok)throw new Error(await i.text());return i.json()}async function f(e){try{return await s("GET",`${c}/repos/${t}/${u}/contents/${e}?ref=${l}`)}catch{return null}}async function p(e,r,n){const i=await f(e),a={message:n,content:btoa(r),branch:l};return i&&(a.sha=i.sha),s("PUT",`${c}/repos/${t}/${u}/contents/${e}`,a)}async function y(e,r){const n=await f(e);if(!n)return;const i={message:r,sha:n.sha,branch:l};return s("DELETE",`${c}/repos/${t}/${u}/contents/${e}`,i)}async function $(e){const r=[];for(let n=0;n<e.length;n+=1e5)r.push(e.slice(n,n+1e5));return r}async function E(e){const r=await o(`${e}/length.dat`),n=await f(r);if(!n)return null;const i=parseInt(atob(n.content));let a="";for(let h=0;h<i;h++){const S=await o(`${e}/${h}.dat`),w=await f(S);if(!w)break;a+=atob(w.content)}return a}async function k(e,r){const n=await $(r);for(let a=0;a<n.length;a++){const h=await o(`${e}/${a}.dat`);await p(h,n[a],`Set chunk ${a} for ${e}`)}const i=await o(`${e}/length.dat`);await p(i,String(n.length),`Set length for ${e}`)}async function L(e){const r=await o(`${e}/length.dat`),n=await f(r);if(!n)return;const i=parseInt(atob(n.content));for(let a=0;a<i;a++){const h=await o(`${e}/${a}.dat`);await y(h,`Delete chunk ${a} of ${e}`)}await y(r,`Delete length of ${e}`)}async function P(){try{await s("GET",`${c}/repos/${t}/${u}`)}catch{await s("POST",`${c}/user/repos`,{name:u,private:!0,auto_init:!0,default_branch:l})}}return{async init(e){try{return d=e,t=(await s("GET",`${c}/user`)).login,await P(),localStorage.setItem("gh-auth-token",e),!0}catch{return!1}},get:E,set:k,delete:L}})();function T({width:u,height:l,path:c,data:d}){document.body.className="frame-body",document.body.style.width=u,document.body.style.height=l;const t=document.createElement("p");t.textContent=`Do you want to write to "${c}" with this data: "${d}"?`,t.className="confirm-message";const o=document.createElement("button");o.textContent="Yes",o.className="confirm-btn";const s=document.createElement("button");s.textContent="No",s.className="cancel-btn",document.body.innerHTML="",document.body.appendChild(t),document.body.appendChild(o),document.body.appendChild(s),o.addEventListener("click",()=>{b.set(c,d),document.body.innerHTML="<h1 class='status success'>Worked</h1>",parent.postMessage("ok","*")}),s.addEventListener("click",()=>{document.body.innerHTML="<h1 class='status cancelled'>Cancelled</h1>",parent.postMessage("false","*")})}function m(u){return document.body.style.color="red",document.body.innerText=u,console.error(u),!1}const g=new URL(`https://gh-acces.duckdns.org/${new URL(document.location).hash.replace("#","")}`);async function H(){const u=g.searchParams.get("w")||innerWidth,l=g.searchParams.get("h")||innerHeight,c=g.searchParams.get("p"),d=g.searchParams.get("data"),t=g.searchParams.get("fn");if(!t)return m("url search param fn (function set/get/delete) have to be setted");if(!c)return m("url search param p (path) have to be setted");for(;!await b.init(localStorage.getItem("gh-auth-token")||prompt("Input github auth token: https://github.com/settings/tokens/new")););if(t!="delete"){if(t!="get"){if(t=="set"){if(!d)return m("url search param data have to be setted");T({width:u,height:l,path:c,data:d})}}}return!0}H();
